<h2>Vote Tallies</h2>

{{#groupBy tallyMeta.tallies key="position_code"}}
    <h3>{{key}}</h3>
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 1em;">
        <thead>
        <tr>
            <th style="text-align: left; border-bottom: 1px solid #ccc;">Candidate</th>
            <th style="text-align: right; border-bottom: 1px solid #ccc;">Votes</th>
        </tr>
        </thead>
        <tbody>
        {{#each items}}
            <tr>
                <td>{{candidate_name}}</td>
                <td style="text-align: right;">{{count}}</td>
            </tr>
        {{/each}}
        </tbody>
    </table>
{{/groupBy}}

<hr style="margin: 2em 0;" />

<h2>QR Code Sheet</h2>

<p><strong>Code:</strong> {{qrMeta.code}}</p>
<p><strong>Split By:</strong> {{qrMeta.by}}</p>

<div style="display: flex; flex-wrap: wrap; gap: 2em; margin-top: 1.5em;">
    {{#each qrMeta.qr}}
        <div style="text-align: center; width: 256px;">
            {{#if (startsWith this "data:image/png")}}
                <img src="{{this}}" width="256" height="256" alt="QR Code {{inc @index}}" />
            {{else if (includes this "data:image/svg+xml;base64")}}
                <div style="width: 256px; height: 256px;">{{{this}}}</div>
            {{else}}
                <p style="color: red;">Unsupported QR format</p>
            {{/if}}
            <p style="margin-top: 0.5em;">QR {{inc @index}}</p>
        </div>
    {{/each}}
</div>
